使用文档 - 金融新闻处理工具 (Financial News Processor)

---
简介
金融新闻处理工具 是一个基于 Outlook 邮箱的 Python 程序，旨在帮助用户从邮件中提取金融相关新闻，并分类整理后导出为 Word 文档。

---
功能列表
1. 连接 Outlook 邮箱
 连接到本地的 Outlook 邮箱并加载邮件文件夹。
2. 筛选与搜索邮件
  - 输入关键词（可选）
  - 选择邮件日期范围
  - 自动过滤并提取邮件内容
3. 新闻分类
 根据用户自定义的关键词，自动将新闻分类到 中国、美国 或 国际 类别。
4. 预览邮件内容
 在程序内预览提取到的邮件主题、日期和内容摘要。
5. 导出 Word 文档
 将分类整理后的新闻导出为一个可读的 Word 文档。
6. 结果清理
 清除搜索结果，重新开始。

---
运行环境与依赖库
7. 操作系统
- 仅支持 Windows 系统（需要 Outlook 支持）。
8. Python 版本
- Python 3.8 及以上版本
9. 依赖库
在使用本程序前，请确保安装以下库：
- pywin32：用于连接 Outlook
pip install pywin32
- python-docx：用于将结果导出到 Word 文档
pip install python-docx
- tkcalendar：用于日期选择控件
pip install tkcalendar
- tkinter：Python 内置的 GUI 库（无需单独安装）

---
操作指南
步骤 1：启动程序
运行 main.py 文件：
python main.py

---
步骤 2：连接 Outlook
1. 打开程序后，点击界面左上角的 “连接Outlook” 按钮。
2. 连接成功后，显示当前邮箱账户名称。

---
步骤 3：选择文件夹
1. 程序会加载 Outlook 邮件的文件夹树。
2. 点击要搜索的目标文件夹（如 收件箱）。

---
步骤 4：设置搜索选项
1. 输入关键词（可选）：多个关键词用逗号 , 分隔。
  - 示例：美联储, 特朗普, 蓝佛安
2. 选择日期范围：
  - 使用 开始日期 和 结束日期 控件，筛选邮件时间范围。
3. 点击 “搜索” 按钮，开始搜索。

---
步骤 5：预览结果
1. 搜索完成后，程序会显示匹配邮件的 主题、时间 和内容摘要。
2. 自动分类新闻到 中国、美国 和 国际 类别。
3. 在预览窗口查看结果。

---
步骤 6：导出 Word 文档
1. 在 导出选项 中设置 Word 文档的保存路径。
2. 点击 “选择路径” 按钮，选择导出文件夹。
3. 点击 “保存到Word”，程序会生成一个带有分类新闻的 Word 文档。
4. 导出成功后，弹窗会提示文档保存的路径。

---
步骤 7：清除结果
点击 “清除结果” 按钮，清空当前搜索和预览内容。

---
Word 文档格式说明
导出的 Word 文档包含以下内容：
1. 标题：邮件内容汇总
2. 生成时间：当前系统时间
3. 搜索时间范围：所选的日期范围
4. 分类新闻： 
  - 中国 News
  - 美国 News
  - 国际 News

---

---
错误处理与提示
1. 连接Outlook失败：
  - 请确保 Outlook 正在运行并正确配置邮箱账户。
2. 未选择文件夹：
  - 请在文件夹树中选择一个目标文件夹。
3. 未找到符合条件的邮件：
  - 请检查关键词或日期范围，确保筛选条件正确。
4. 导出路径不存在：
  - 选择一个有效的文件夹作为导出路径。
5. 运行时缺少依赖：
  - 请安装必要的依赖库（见上方依赖库部分）。

---
常见问题
1. Q：我无法连接 Outlook？
A：请确保本地安装了 Outlook 并已配置账户，同时程序使用的是与 Outlook 相同的用户权限。
2. Q：导出的 Word 文档无法打开？
A：请检查文件路径是否正确，且 Word 是否安装正确。
3. Q：为什么搜索不到符合条件的邮件？
A：可能是关键词或日期范围不匹配，尝试放宽搜索条件。
4. Q：如何添加新的新闻分类？
A：在代码中修改 self.classification_keywords 字典，添加新的关键词分类。
self.classification_keywords = {
    "中国": ["中国", "央行", "财政部"],
    "美国": ["美国", "美联储"],
    "欧洲": ["欧洲", "欧央行", "法国"]
}

---
总结
本工具旨在简化金融相关邮件的筛选、分类和导出流程，适合需要处理大量金融新闻的用户。
 通过简单的 GUI 操作，用户可以高效地提取有用信息并生成 Word 报告。
如有进一步需求或问题，请根据提示信息进行排查或联系开发者。

